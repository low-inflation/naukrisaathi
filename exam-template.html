<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title id="examTitle">Exam Details - Naukri Saathi</title>
  <!-- Add your styles and CSS links here -->
</head>
<body>
  <h1 id="exam-title">Loading...</h1>
  <div class="info-box" id="why-box"></div>
  <h2>🔍 About the Exam</h2><ul id="about-list"></ul>
  <h2>🎓 Who Can Apply?</h2><ul id="eligibility-list"></ul>
  <h2>💼 Job Roles</h2><ul id="roles-list"></ul>
  <h2>📝 Exam Pattern</h2><ul id="pattern-list"></ul>
  <h2>📅 Important Dates</h2>
  <table id="dates-table"><thead><tr><th>Event</th><th>Date</th></tr></thead><tbody></tbody></table>
  <h2>💡 Tips</h2><ul id="tips-list"></ul>
  <div class="warning-box" id="warning-box" style="display:none;"></div>
  <h2>🔗 Resources</h2>
  <ul>
    <li><a id="pdf-link" href="#" target="_blank">Notification / Syllabus</a></li>
    <li><a id="pyq-link" href="#" target="_blank">Previous Year Papers</a></li>
  </ul>
  <h2>📺 YouTube Study Links</h2><ul id="youtube-list"></ul>
  <h2>🌐 Official Website</h2><p><a id="official-site" href="#" target="_blank">Visit Official Website</a></p>
  <h2>📝 How to Apply</h2><a id="apply-link" href="#" target="_blank">Apply Online</a>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRVh2Dak5NekD_LAZjqbR4QRqkBmqrY0Jxm3E8Svle-6yhjebjbSWJGVZ1AAKIKuJVKL09XnoZxUlFj/pub?output=tsv";

      function getExamIdFromUrl() {
        const params = new URLSearchParams(window.location.search);
        return params.get("id") || "";
      }

      function splitList(text) {
        if (!text) return [];
        return text.split("|").map(item => item.trim()).filter(item => item);
      }

      fetch(sheetUrl)
        .then(res => res.text())
        .then(text => {
          const rows = text.trim().split("\n").map(r => r.split("\t"));
          const headers = rows[0].map(h => h.trim().toLowerCase());
          const dataRows = rows.slice(1);

          const examId = getExamIdFromUrl();
          const examRow = dataRows.find(r => r[0].trim() === examId);

          if (!examRow) {
            document.getElementById("exam-title").textContent = "Exam Not Found";
            return;
          }

          const examData = {};
          headers.forEach((header, i) => {
            examData[header] = (examRow[i] || "").trim();
          });

          document.getElementById("exam-title").textContent = examData.title || "No Title";

          // Why Points
          const whyBox = document.getElementById("why-box");
          whyBox.innerHTML = "";
          if (examData.why_points) {
            whyBox.innerHTML = `<strong>Why this job is good for you:</strong><br>` +
              splitList(examData.why_points).map(p => `✔ ${p}`).join("<br>");
          }

          // Lists
          const listFields = {
            "about-list": "about_points",
            "eligibility-list": "eligibility_list",
            "roles-list": "roles_list",
            "pattern-list": "pattern_list",
            "tips-list": "tips_list"
          };
          for (const [elId, field] of Object.entries(listFields)) {
            const ul = document.getElementById(elId);
            ul.innerHTML = "";
            splitList(examData[field]).forEach(item => {
              const li = document.createElement("li");
              li.textContent = item;
              ul.appendChild(li);
            });
          }

          // Dates Table
          const datesTbody = document.querySelector("#dates-table tbody");
          datesTbody.innerHTML = "";
          splitList(examData.dates_table).forEach(row => {
            const [event, date] = row.split(":").map(s => s.trim());
            if (event && date) {
              const tr = document.createElement("tr");
              tr.innerHTML = `<td>${event}</td><td>${date}</td>`;
              datesTbody.appendChild(tr);
            }
          });

          // Warnings
          const warningBox = document.getElementById("warning-box");
          if (examData.warnings_list) {
            warningBox.style.display = "block";
            warningBox.innerHTML = `<strong>Common mistakes to avoid:</strong><br>` +
              splitList(examData.warnings_list).map(w => `❌ ${w}`).join("<br>");
          }

          // Links
          document.getElementById("pdf-link").href = examData.pdf_link || "#";
          document.getElementById("pyq-link").href = examData.pyq_link || "#";
          document.getElementById("official-site").href = examData.official_website || "#";
          document.getElementById("apply-link").href = examData.apply_link || "#";

          // YouTube Links
          const ytList = document.getElementById("youtube-list");
          ytList.innerHTML = "";
          const ytItems = splitList(examData.youtube_list);
          for (let i = 0; i < ytItems.length; i += 2) {
            const title = ytItems[i] || `Video ${i / 2 + 1}`;
            const url = ytItems[i + 1] || "#";
            const li = document.createElement("li");
            li.innerHTML = `📺 <a href="${url}" target="_blank" rel="noopener noreferrer">${title}</a>`;
            ytList.appendChild(li);
          }
        })
        .catch(err => {
          console.error("Error loading exam data:", err);
          document.getElementById("exam-title").textContent = "Failed to load exam data.";
        });
    });
  </script>
</body>
</html>
